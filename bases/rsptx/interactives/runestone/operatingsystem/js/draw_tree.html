<!DOCTYPE html>
<meta charset="utf-8">
<body>

<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js"></script>
<script src="https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js"></script>
<div id="graph" style="text-align: center;"></div>

<script>
    const linksCsv = 'child,parent\na,\nb,a\nc,a\nd,a\ne,b\nf,c\ng,c\nh,d\ni,h';

    const links = d3.csvParse(linksCsv);
    console.log(links)

    const childColumn = links.columns[0];
    const parentColumn = links.columns[1];

    const stratify = d3.stratify()
        .id(d => d[childColumn])
        .parentId(d => d[parentColumn]);
        
    const root = stratify(links);
    console.log(root.data);

    var digraphString = 'digraph {';
    for (var i = 0; i < links.length; i++) {
        var c = links[i][childColumn];
        var p = links[i][parentColumn];
        if (p) { digraphString += `${p} -> ${c};` }
    }
    digraphString += "}";

    console.log(digraphString);

    d3.select("#graph").graphviz()
        .renderDot(digraphString);
    
</script>
